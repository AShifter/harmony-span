<!DOCTYPE html>
<html lang="en">
    <head>
        <title>HarmonySpan Configuration Utility</title>
        <style>
            body
            {
                font-family: sans-serif;
                font-size: 14pt;
                background-color: #222222;
            }
            label
            {
                font-family: sans-serif;
                font-size: 10pt;
                font-style: italic;
                padding-right: 10px;
            }
            .navbar
            {
                margin: 0.5%;
                margin-left: 15%;
                margin-right: 15%;
                padding: 0.5%;
                padding-left: 2%;
                background-color: lightgrey;
                border-radius: 25px;
            }
            .configpane
            {
                margin: 0.5%;
                margin-left: 15%;
                margin-right: 15%;
                padding: 0.5%;
                padding-left: 2%;
                background-color: lightgrey;
                border-radius: 25px;
                display: block;
                text-align:center;
            }
            .button
            {
                background-color:#44c767;
	            border-radius:28px;
	            border:0px solid black;
	            display:inline-block;
	            cursor:pointer;
	            color:#ffffff;
	            padding:5px;
            }
            .rounded
            {
                background-color:white;
	            border-radius:28px;
	            border:0px solid black;
	            display:inline-block;
	            padding:5px;
            }
            .rounded:active
            {
                border:0px solid black;
            }
        </style>
        <script>
            var getJSON = function(url, callback)
            {
                var xhr = new XMLHttpRequest();
                xhr.open('GET', url, true);
                xhr.responseType = 'json';
                xhr.onload = function()
                {
                    var status = xhr.status;
                    if (status === 200)
                    {
                        callback(null, xhr.response);
                    }
                    else
                    {
                        callback(status, xhr.response);
                    }
                };
                xhr.send();
            };

            function updateValues()
            {
                getJSON("http://localhost:8060/config/config.json", function(err, data)
                {
                    document.getElementById("webhookname").value = data.Buttons[document.getElementById("buttons").selectedIndex].label;
                    document.getElementById("webhookurl").value = data.Buttons[document.getElementById("buttons").selectedIndex].url;
                    document.getElementById("webhookheader").value = data.Buttons[document.getElementById("buttons").selectedIndex].header;
                    document.getElementById("webhookcontent").value = data.Buttons[document.getElementById("buttons").selectedIndex].query;
                    document.getElementById("requesttypes").value = data.Buttons[document.getElementById("buttons").selectedIndex].requesttype;
                })
            }

            function submitButtons()
            {
                writeConfig("http://localhost:8060/config/write/btn?btn=" + document.getElementById("buttons").selectedIndex + "&lbl=" + document.getElementById("webhookname").value + "&url=" + document.getElementById("webhookurl").value + "&rqt=" + document.getElementById("requesttypes").value + "&hdr=" + document.getElementById("webhookheader").value + "&qry=" + document.getElementById("webhookcontent").value);
            }

            function writeConfig(url)
            {
                requestWindow = window.open(url, "", "width=1,height=1");
                setTimeout(() => {  requestWindow.close(); }, 1000);
            }
        </script>
    </head>
    <body onload="updateValues()">
        <div class="navbar">
            <a href="https://github.com/AShifter/harmony-span"><h5 style="margin-bottom: 0px;">HarmonySpan Configuration Utility</h5></a>
            <label type="text" for="version">HarmonySpan v1.3</label>
            <label type="text" for="version">//</label>
            <label type="text" for="version">Built by Logan Lowe</label>
            <label type="text" for="version">//</label>
            <label type="text" for="version">Huge thanks to <b>Matt Ording</b>, <a href="https://www.youtube.com/c/buildmontage"><b>Tony James</b></a>, and the entire <b>Home Theater community</b> for making this project possible!</label>
            <br>
            <br>
        </div>
        <div class="configpane">
            <label type="select" for="buttons">Currently editing HarmonySpan button;</label>
            <br>
            <select name="buttons" id="buttons" onChange="updateValues()" class="rounded">
                <option value="Home">Home</option>
                <option value="Rev">Rev</option>
                <option value="Fwd">Fwd</option>
                <option value="Play">Play</option>
                <option value="Select">Select</option>
                <option value="Up">Up</option>
                <option value="Down">Down</option>
                <option value="Left">Left</option>
                <option value="Right">Right</option>
                <option value="Back">Back</option>
                <option value="InstantReplay">InstantReplay</option>
                <option value="Info">Info</option>
                <option value="Backspace">Backspace</option>
                <option value="Search">Search</option>
                <option value="Enter">Enter</option>
            </select>
        </div>
        <div class="configpane">
            <label type="text" for="webhookname">Webhook Name</label>
            <br>
            <input class="rounded" type="text" id="webhookname" size="75"></input>
            <br>
            <br>
            <label type="text" for="webhookurl">Webhook URL</label>
            <br>
            <input class="rounded" type="text" id="webhookurl" size="75"></input>
            <br>
            <br>
            <label type="text" for="webhookheader">Webhook Header</label>
            <br>
            <input class="rounded" type="text" id="webhookheader" size="75"></input>
            <br>
            <br>
            <label type="text" for="webhookcontent">Webhook Content</label>
            <br>
            <input class="rounded" type="text" id="webhookcontent" size="75"></input>
            <br>
            <br>
            <label type="select" for="requesttypes">Webhook Request Type</label>
            <br>
            <select name="requests" id="requesttypes" class="rounded">
                <option value="POST">POST</option>
                <option value="GET">GET</option>
            </select>
            <br>
            <br>
            <input type="button" class="button" value="Submit Settings" onclick="submitButtons()"/>
        </div>
    </body>
</html>
